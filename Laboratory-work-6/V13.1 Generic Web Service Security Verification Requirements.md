# V13.1 Загальна безпека веб-служб / Generic Web Service Security Verification Requirements
| L1 | L2 | L3 | CWE | 
|-------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----|----|----|-----|
|13.1.1 | Переконайтеся, що всі компоненти програми використовують однакові кодування та аналізатори, щоб уникнути атак синтаксичного аналізу, які використовують різні URI або поведінку аналізу файлів, які можуть використовуватися в атаках SSRF і RFI.|  ✓ | ✓  | ✓  | 116 |
|13.1.3 | Переконайтеся, що URL-адреси API не розкривають конфіденційну інформацію, таку як ключ API, маркери сеансу тощо. |  ✓ | ✓  | ✓  | 598 |
|13.1.4 | Переконайтеся, що рішення щодо авторизації приймаються як на URI, що забезпечується програмним чи декларативним захистом на контролері чи маршрутизаторі, так і на рівні ресурсу, що забезпечується дозволами на основі моделі.|    | ✓  | ✓  | 285 |
|13.1.5 | Переконайтеся, що запити, які містять неочікувані або відсутні типи вмісту, відхиляються відповідними заголовками (статус відповіді HTTP 406 Неприйнятний або 415 Непідтримуваний тип носія). |    | ✓  | ✓  | 434 |

## CWE-116: Неправильне кодування або екранування вихідних даних / Improper Encoding or Escaping of Output

### Опис

Програмне забезпечення готує структуроване повідомлення для зв’язку з іншим компонентом, але кодування або екранування даних відсутні або виконуються неправильно. У результаті запланована структура повідомлення не зберігається.

### Розширений опис

Неправильне кодування або екранування може дозволити зловмисникам змінювати команди, які надсилаються іншому компоненту, вставляючи замість них шкідливі команди.

Більшість програмного забезпечення працює за певним протоколом, який використовує структуровані повідомлення для зв’язку між компонентами, наприклад запитами чи командами. Ці структуровані повідомлення можуть містити необроблені дані з вкрапленням метаданих або керуючої інформації. Наприклад, «GET /index.html HTTP/1.1» — це структуроване повідомлення, що містить команду («GET») з одним аргументом («/index.html») і метадані про те, яка версія протоколу використовується («HTTP/ 1,1").

Якщо програма використовує вхідні дані, надані зловмисником, для створення структурованого повідомлення без належного кодування або екранування, тоді зловмисник може вставити спеціальні символи, які спричинять інтерпретацію даних як керуючої інформації або метаданих. Отже, компонент, який отримує вихідні дані, виконуватиме неправильні операції або іншим чином неправильно інтерпретуватиме дані.

### Застосовні платформи

#### Мови
Клас: Не залежить від мови (часто поширений)

#### Технології
Сервер бази даних (часто поширений)
Веб-сервер (часто поширений)

### Загальні наслідки

  | Область застосування | Вплив                                                                                           |
  |------------------|-------------------------------------------------------------------------------------------------|
  | Цілісність | Зв'язок між компонентами може бути змінений несподіваним чином. Неочікувані команди можуть виконуватися в обхід інших механізмів безпеки. Вхідні дані можуть бути неправильно витлумачені.|
  | Доступність | Зв'язок між компонентами може бути змінений несподіваним чином. Неочікувані команди можуть виконуватися в обхід інших механізмів безпеки. Вхідні дані можуть бути неправильно витлумачені.|
  | Конфіденційність | Зв'язок між компонентами може бути змінений несподіваним чином. Неочікувані команди можуть виконуватися в обхід інших механізмів безпеки. Вхідні дані можуть бути неправильно витлумачені.|
 
### Ймовірність експлойту 

Висока

## CWE-285: Неналежний дозвіл / Improper Authorization

### Опис

Програмне забезпечення не виконує або неправильно виконує перевірку авторизації, коли актор намагається отримати доступ до ресурсу або виконати дію.

### Розширений опис

Припускаючи, що користувач має певну ідентифікаційну інформацію, авторизація – це процес визначення того, чи може цей користувач отримати доступ до даного ресурсу, на основі привілеїв користувача та будь-яких дозволів або інших специфікацій контролю доступу, які застосовуються до ресурсу.

Коли перевірки контролю доступу не застосовуються послідовно або взагалі не застосовуються, користувачі можуть отримувати доступ до даних або виконувати дії, які їм заборонено виконувати. Це може призвести до широкого спектру проблем, включаючи розкриття інформації, відмову в обслуговуванні та довільне виконання коду.

### Застосовні платформи

#### Мови
Клас: не залежить від мови (поширеність не визначена)

#### Технології

Веб-сервер (часто поширений)

Сервер бази даних (часто поширений)

### Загальні наслідки

  | Область застосування | Вплив                                                                                           |
  |------------------|-------------------------------------------------------------------------------------------------|
  | Конфіденційність | Зловмисник може прочитати конфіденційні дані, прочитавши дані безпосередньо зі сховища даних, яке належним чином не обмежено, або отримавши доступ до недостатньо захищеної привілейованої функції для читання даних. |
  | Цілісність | Зловмисник може змінити конфіденційні дані, або записавши дані безпосередньо в сховище даних, яке не має належних обмежень, або отримавши доступ до недостатньо захищеної привілейованої функції для запису даних. |
  | Управління доступом | Зловмисник може отримати привілеї шляхом безпосередньої зміни або читання критичних даних або доступу до недостатньо захищених привілейованих функцій. |

### Ймовірність експлойту 

Висока
 
## CWE-434: Необмежене завантаження файлу небезпечного типу / Unrestricted Upload of File with Dangerous Type

### Опис
Програмне забезпечення дозволяє зловмиснику завантажувати або передавати файли небезпечного типу, які можуть автоматично оброблятися в середовищі продукту.

### Застосовні платформи

#### Мови

ASP.NET (іноді поширений)

PHP (часто поширений)

Клас: не залежить від мови (поширеність не визначена)

#### Технології

Веб-сервер (іноді переважає)

### Загальні наслідки

  | Область застосування | Вплив                                                                                           |
  |------------------|-------------------------------------------------------------------------------------------------|
  | Цілісність, конфіденційність, доступність | Виконання довільного коду можливе, якщо завантажений файл інтерпретується та виконується одержувачем як код. Особливо це стосується розширень .asp і .php, завантажених на веб-сервери, оскільки ці типи файлів часто розглядаються як автоматично виконувані, навіть якщо дозволи файлової системи не вказують на виконання. Наприклад, у середовищах Unix програми зазвичай не можуть запускатися, якщо не встановлено біт виконання, але програми PHP можуть виконуватися веб-сервером без безпосереднього виклику їх в операційній системі. |
 
### Ймовірність експлойту 

Середня

## CWE-598: використання методу запиту GET із конфіденційними рядками запиту / Use of GET Request Method With Sensitive Query Strings

### Опис

Веб-програма використовує метод HTTP GET для обробки запиту та включає конфіденційну інформацію в рядок запиту цього запиту.

### Розширений опис

Рядок запиту для URL-адреси можна зберегти в історії веб-переглядача, передати через Referers на інші веб-сайти, зберегти у веб-журналах або іншим чином записати в інших джерелах. Якщо рядок запиту містить конфіденційну інформацію, таку як ідентифікатори сеансу, то зловмисники можуть використовувати цю інформацію для здійснення подальших атак.

### Загальні наслідки

  | Область застосування | Вплив                                                                                           |
  |------------------|------------------------------------------------------------------------------------------------- |
  | Конфіденційність | Як мінімум, зловмисники можуть зібрати інформацію з рядків запиту, яку можна використати для ескалації свого методу атаки, наприклад інформацію про внутрішню роботу програми або назви стовпців бази даних. Успішне використання вразливості параметрів рядка запиту може призвести до того, що зловмисник видасть себе за законного користувача, отримає конфіденційні дані або просто виконає дії, не передбачені розробниками програми. |
  
 
